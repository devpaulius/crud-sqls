generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id               Int     @id @default(autoincrement())
  username         String  @unique
  email            String  @unique
  password         String
  first_name       String?
  last_name        String?
  middle_name      String?
  acknowledged     Boolean @default(false)
  ip_address       String?
  theme_preference String  @default("light")
  is_admin         Boolean @default(false)
  public_profile   Boolean @default(true)
  blocked          Boolean @default(false)

  postsCreated Post[] @relation("CreatedPosts")
  postsUpdated Post[] @relation("UpdatedPosts")
  likes        PostLike[]
}

model Category {
  id   Int    @id @default(autoincrement())
  name String @unique
  posts Post[]
}

model Post {
  id           Int       @id @default(autoincrement())
  title        String
  content      String
  created_at   DateTime  @default(now())
  updated_at   DateTime  @updatedAt
  scheduled_at DateTime?
  likes        Int       @default(0)
  approved     Boolean   @default(true)

  categoryId Int?
  category   Category? @relation(fields: [categoryId], references: [id])

  createdById Int
  createdBy   User @relation("CreatedPosts", fields: [createdById], references: [id])

  updatedById Int
  updatedBy   User @relation("UpdatedPosts", fields: [updatedById], references: [id])

  likesBy PostLike[]
}

model PostLike {
  userId Int
  postId Int

  user User @relation(fields: [userId], references: [id])
  post Post @relation(fields: [postId], references: [id])

  @@id([userId, postId])
}
